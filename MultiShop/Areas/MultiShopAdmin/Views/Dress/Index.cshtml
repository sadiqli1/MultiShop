@model List<Dress>
@{
    ViewData["Title"] = "Index";
}

<div class = "main-panel">
    <div class = "content-wrapper">
        <div class = "row">
            <div class = "col-lg-12 grid-margin stretch-card">
                <div class = "card">
                    <div class = "card-body">
                        <div>
                            <a class = "btn btn-success" style = "color : white" asp-area = "MultiShopAdmin" asp-controller = "dress" asp-action = "create">Create Dress</a>
                        </div>
                        <div class="table-responsive pt-3">
                    <table class="table table-dark">
                      <thead>
                        <tr>
                          <th>
                            Id
                          </th>
                          <th>
                            Image
                          </th>
                          <th>
                            Name
                          </th>
                          <th>
                            Description
                          </th>
                          <th>
                            Price
                          </th>
                          <th>
                            Settings
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        @foreach (Dress dress in Model)
                       {
                           <tr>
                          <td>
                            @dress.Id
                          </td>
                          <td>
                            <img src = "~/assets/img/@dress.Images.FirstOrDefault(i => i.isMain == false).Name" />
                          </td>
                          <td>
                            @dress.Name
                          </td>
                          <td>
                            @dress.Desc
                          </td>
                          <td>
                            $@dress.Price
                          </td>
                          <td class = "d-flex">
                            <div>
                                <a class = "btn btn-warning" asp-area = "MultiShopAdmin" asp-controller = "dress" asp-action = "Update" asp-route-id = "@dress.Id"><i class = "mdi mdi-border-color"></i></a>
                            </div>
                            <div>
                                <a class = "btn btn-danger delete" asp-area = "MultiShopAdmin" asp-controller = "dress" asp-action = "Delete" asp-route-id = "@dress.Id"><i class = "mdi mdi-delete"></i></a>
                            </div>
                            <div>
                                <a class = "btn btn-success" asp-area = "MultiShopAdmin" asp-controller = "dress" asp-action = "Detail" asp-route-id = "@dress.Id"><i class = "mdi mdi-details"></i></a>
                            </div>
                          </td>
                        </tr>
                       }
                      </tbody>
                    </table>
                  </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section ScriptCategory{
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
     <script>
    let btn = document.querySelector(".delete");
    btn.addEventListener("click", (e) => {
        e.preventDefault();
        let href=e.currentTarget.getAttribute("href")
        Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',  
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
    }).then((result) => {
     
        if (result.isConfirmed) {
               fetch(href).then(response=>response.json())
        .then(data=>{
            if(data.status==200){
                  Swal.fire(
                'Deleted!',
                'Your file has been deleted.',
            'success'
         )
                location.reload(true)
            }
        })
          
    }
})
    })
  </script>
}